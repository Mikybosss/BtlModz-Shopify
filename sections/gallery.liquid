<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gallery</title>
    <style>
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        .gallery-item {
            border: 2px solid #ccc;
            border-radius: 5px;
            overflow: hidden;
        }
        .gallery-item img {
            width: 100%;
            height: 200px; /* Fixed height for uniform image size */
            object-fit: cover;
            display: block;
        }
        .gallery-item .caption {
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }
        .gallery-item .description {
            padding: 5px 10px;
            text-align: center;
            font-style: italic;
            color: #666;
        }
        .lightbox {
            display: none;
            position: fixed;
            z-index: 9999;
            padding-top: 60px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            cursor: pointer; /* Allows clicking on the lightbox to close */
        }
        .lightbox-content {
            position: relative;
            margin: auto;
            padding: 10px;
            width: 80%;
            max-width: 700px;
            cursor: default; /* Prevents clicking inside the image from closing the lightbox */
        }
        .lightbox-content img {
            width: 100%;
            height: auto;
        }
        .lightbox .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
        }
        .lightbox .close:hover,
        .lightbox .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="page-width">
    <h1>{{ section.settings.title }}</h1>
    <div class="gallery">
        {% for block in section.blocks %}
            {% if block.settings.image %}
                <div class="gallery-item">
                    <a href="javascript:void(0);" onclick="openLightbox('{{ block.settings.image | img_url: 'master' }}')">
                        <img src="{{ block.settings.image | img_url: 'master' }}" alt="{{ block.settings.title }}" height="200" width="200">
                    </a>
                    <div class="caption" 
                         onmouseover="changeText(this, 'Customize this frame')" 
                         onmouseout="resetText(this, '{{ block.settings.title }}')" 
                         onclick="redirectToPage('https://btlmodz.myshopify.com/pages/customize-a-frame')">
                        {{ block.settings.title }}
                    </div>
                    <div class="description">{{ block.settings.description }}</div>
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <!-- Lightbox container -->
    <div id="lightbox" class="lightbox" onclick="closeLightbox()">
        <span class="close" onclick="event.stopPropagation(); closeLightbox()">&times;</span>
        <div class="lightbox-content" onclick="event.stopPropagation()">
            <img id="lightbox-image" src="" height="200" width="200">
        </div>
    </div>

    <script>
        function openLightbox(imageUrl) {
            var lightbox = document.getElementById('lightbox');
            var lightboxImage = document.getElementById('lightbox-image');
            lightbox.style.display = 'block';
            lightboxImage.src = imageUrl;
        }

        function closeLightbox() {
            var lightbox = document.getElementById('lightbox');
            lightbox.style.display = 'none';
        }

        function changeText(element, text) {
            element.dataset.originalText = element.innerText;
            element.innerText = text;
        }

        function resetText(element, originalText) {
            element.innerText = element.dataset.originalText || originalText;
        }

        function redirectToPage(url) {
            window.location.href = url;
        }
    </script>
    </div>
</body>
</html>
{% schema %}
{
  "name": "Gallery Settings",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "info": "Enter the title of the images you want to display in the gallery",
      "default": "Gallery"
    }
  ],
  "blocks": [
    {
      "type": "Image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Image Title"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Image Description"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Gallery",
      "category": "Gallery"
    }
  ]
}
{% endschema %}
